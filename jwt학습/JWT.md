# JWT

https://jwt.io/

JSON Web Token (JWT)은 JSON 객체로서 당사자간에 안전하게 정보를 전송할 수있는 작고 독립적 인 방법을 정의하는 공개 표준 (RFC 7519)입니다. 이 정보는 디지털로 서명 되었기 때문에 검증되고 신뢰할 수 있습니다. JWT는 RSA 또는 ECDSA를 사용하는 비밀 (HMAC 알고리즘 사용) 또는 공용 / 개인 키 쌍을 사용하여 서명 할 수 있습니다.

RFC 7519 : x

- 벨연구소 내부망을 구축하여 선이 연결되어 있고 연결된 허브로 데이터 송수신
- A연구소와 벨 연구소 통신을 하기 위해 규칙 정함
- 데이터 요청 방식 get ?name="홍길동" 약속된 규칙 RFC1번 문서(약속된 문서 방식을 프로토콜이라 부름)
- B연구소와 통신하기 위한 규칙을 정함
- RFC 2번 문서 ... 규약으로 7519...
- JWT는 7519 규약으로 만들어짐

=> WWW (RFC 문서의 약속으로 만들어짐)

## JWT 웹 토큰

- JSON 객체로 안전하게 전송
- 암호화로 당사자 간 비밀을 제공할 수도 있으나 서명(전자서명) 된 토큰에 중점

## 구조

header,
payload,
signature

xxxxx.yyyyy.zzzzz

### header

- alg(알고리즘), typ(타입)
- Base64Url 인코딩 (암호화, 복호화-디코딩 가능)

### payload

- 클레임(등록된 클레임, 개인 클레임)
- 등록된 클레임(권장) : 발행자, 만료시간, 주제. 청중 등
- 개인 클레임 : primary키를 담아서 user정보 담을 수 있음

### signature

- 헤더, 페이로드, secret key(서버만 알고 있음)로 암호화

### hs256

```
클라이언트                          서버
        ---------------------->>
        로그인 시도
                                header - hs256
                                payload - { username: chan }
                                signiture - header+payload+서버가 갖고 있는 키 값
                                          -> hs256으로 암호화
                                          *hs(HMAC SHA256 : 시크릿키를 포함한 해쉬-복호화x)
                                각각을 Base64로 암호화 후
        <<---------------------
웹브라우저
로컬 스토리지 저장
        --------------------->>
        인증 필요한 요청 + JWT
                                JWT 검증 (유효한가?)
                                header+payload+코스 => hs256 암호화
                                받은 signiture와 같은지 확인! ok
                                payload, username 확인! ok
```

### rsa

개인키, 공개키

```
클라이언트                          서버
        ---------------------->>
        로그인 시도
                                header - rsa
                                payload - { username: chan }
                                signiture - header+payload
                                            개인키로 암호화
                                토큰
        <<---------------------
웹브라우저
로컬 스토리지 저장
        --------------------->>
        인증 필요한 요청 + JWT
                                JWT 검증 (유효한가?)
                                공개키로 signiture 열어
                                (전자서명, 내 서버에서 나갔던 애 맞네!)
```
